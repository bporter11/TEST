Tools inventory Excel Parser
-----------------



# Assume df is your DataFrame with the 'Order Number' column
data = {'Order Number': ['EC-123456', 'EC-789012', 'canceled', 'EC-345678', 'other']}
df = pd.DataFrame(data)

# Define a regular expression pattern for the desired format
pattern = r'^EC-\d{6}$'

# Use str.contains to filter rows based on the pattern
filtered_df = df[df['Order Number'].str.contains(pattern, na=False)]

# Assume finance_df is your other DataFrame with the 'PO/SR' column
finance_data = {'PO/SR': ['EC-123456', 'SA-789012', 'canceled', 'EC-345678', 'other']}
finance_df = pd.DataFrame(finance_data)

# Check if elements in the 'Order Number' column of filtered_df match any elements in 'PO/SR' column of finance_df
matched_rows = filtered_df[filtered_df['Order Number'].isin(finance_df['PO/SR'])]

# Display the resulting DataFrame
print(matched_rows)



matched_rows['Combined Descriptions'] = matched_rows['Description'] + " " + finance_df['Item Description / Projects Batch']

# Print the count of matching rows
print("Number of matches:", len(matched_rows))

# Display the resulting DataFrame
print(matched_rows[['Order Number', 'Description', 'Combined Descriptions']])


file_path = r'C:\Users\brian.porter2\Documents\TOOLS\Tools_Inventory_CLEANED.xlsx'

# Save the DataFrame to the specified Excel file and sheet
matched_rows[['Order Number', 'Description', 'Combined Descriptions']].to_excel(file_path, sheet_name='Sheet2', index=False)

print("Data saved to Excel file:", file_path)
